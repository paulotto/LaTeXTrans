    \centering
    \captionsetup{type=figure}
    \begin{subfigure}[t]{1.0\linewidth}
        \input{graphs/moe/moe_scaleflops_avg}
    \end{subfigure}
    \begin{tikzpicture}
        \node[anchor=north] (legend) at (0\linewidth, 0) {
            \begin{axis}[
                        hide axis, %
                        xmin=0, xmax=0.5, ymin=0, ymax=1, %
                        legend columns=3, %
                        legend style={
                            at={(-0.14, -0.04)}, %
                            anchor=north, %
                            /tikz/every even column/.append style={column sep=0.2cm}, %
                            scale=0.5,
                            cells={align=left}, font=\scriptsize,
                            anchor=center,
                        },
                    ]
                \addlegendimage{legend moe_0_2b style}
                \addlegendentry{0.275B}
                \addlegendimage{legend moe_0_4b style}
                \addlegendentry{0.464B}
                \addlegendimage{legend moe_0_9b style}
                \addlegendentry{0.932B}
                \addlegendimage{legend moe style}
                \addlegendentry{1.627B}
                \addlegendimage{legend moe_2_2b style}
                \addlegendentry{2.280B}
                \addlegendimage{legend moe_3_3b style}
                \addlegendentry{3.354B}
            \end{axis}
        };
    \end{tikzpicture}
    \vspace{20pt}
    \caption{\textbf{Scaling laws for sparse early-fusion NMMs.} We report the final validation loss averaged across interleaved,
    image-captions and text data.}
    \label{fig:early_scaleflops_moe_avg}
